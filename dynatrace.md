# Dynatrace Integration Research

> for Python-TLO internal use only

**Authored by:** Oleg Orlov (oleg.orlov@edwardjones.com)  
**Purpose:** This document serves as a research summary on integrating Dynatrace telemetry ingestion with the python repository template.

---

## Summary

- **Logs:** Supported natively. Logs ingestion works out of the box but is currently not generally available (GA). Expected GA in **July**.
- **Metrics:** Supported by extending the repository template with Prometheus metrics collection.
- **Traces:** Not supported natively for our setup (Alpine-based images). Direct OpenTelemetry (OTEL) data ingestion to Dynatrace is required, but this involves substantial manual setup and will be reviewed as needed. 

---

## What is Dynatrace?

Dynatrace is an observability platform that provides monitoring and performance insights into applications, infrastructure, and user experience. It allows teams to detect, resolve, and prevent issues across hybrid, multi-cloud, and on-premises environments.

Dynatrace supports **end-to-end observability** by capturing logs, metrics, and traces through automated OneAgent integration and other methods such as Prometheus and OpenTelemetry (OTEL) ingestion.

---

## Organizational Support for Dynatrace

Our **CD Tools team** provides support for Dynatrace. For integration requests or troubleshooting, refer to the following resources:

- [CD Tools Request Page](link)
- [Dynatrace Wiki](link)
- [Dynatrace SharePoint Main Page](link)
- [Management Zone Wiki](link)

### Dynatrace Deployments:
1. **Production Environment:** [prod](https://link)  
2. **Non-Production Environment:** [non-prod](https://link)  

### Access Requests

Dynatrace access is managed via SNOW tickets, which can be initiated here: [CD Tools Request Page](link).

---

## Core Concept: Management Zones (MZ)

A **Management Zone (MZ)** in Dynatrace is a logical boundary or filter that defines access to telemetry data. MZs allow teams to focus only on the data relevant to their applications.

### Accessing Data via MZ

Teams must first onboard their application to a Management Zone. This process involves:

1. Creating an **Active Directory (AD) group**.
2. Submitting a request to onboard the MZ (including the AD group name).
3. Requesting the AD group to be assigned to the MZ.

#### TLO-Python Management Zone Info

- **Name:** TLO-Python  
- **AD Group:** tlo-python-group  
- **SNOW Request:** [link](link)  
- **AD Group Request:** [link](link)  

For more detailed instructions, see the [Management Zone Wiki](link).

---

## Overview: How Dynatrace Works

The current implementation follows the **Cloud Native Full Stack Mode** model ([details](https://docs.dynatrace.com/docs/ingest-from/setup-on-k8s/how-it-works/cloud-native-fullstack)). 

### What is Cloud Native Full Stack Mode?

This model leverages the Dynatrace OneAgent for Kubernetes, enabling fully automated telemetry collection (metrics, traces, logs). It seamlessly integrates with containerized environments, providing visibility across clusters, workloads, and applications. 

---

## Key Limitations

### Python OneAgent SDK Compatibility

According to the [Dynatrace Platform Support Matrix](https://docs.dynatrace.com/docs/ingest-from/technology-support/oneagent-platform-and-capability-support-matrix), the **Python OneAgent SDK is not compatible with Alpine-based Docker images**.  

As our applications use Alpine, default SDK-based ingestion methods (for metrics, traces, and logs) are not viable. We’ve addressed this with alternative solutions:

---

### Logs

**Current Status (as of 2025-06-03):**

- Logs are automatically collected by the Dynatrace OneAgent.
- SRE team is working on automating resource and permission creation for general availability. Expected completion: **July**. 
- Logs generated by a test app were successfully ingested into Dynatrace. However, these logs are **not yet accessible to end users**, pending SRE team automation efforts.

**Result:** Once GA, no extra steps will be required for logs collection in Python-based applications.

---

### Metrics

Given the OneAgent SDK's limitation on Alpine, we evaluated two metrics ingestion methods:

1. **Prometheus Metrics Ingestion:** This option was **selected** due to its simplicity and reliability.
2. **OpenTelemetry (OTEL):** Rejected at this stage due to the risk of data loss and additional setup complexity.

**Implementation:** Prometheus metrics collection is now enabled in the repository template. This approach requires no extra configuration from end users.

---

### Traces

For tracing, the only feasible option with our Alpine setup is **OTEL data ingestion**. However, OTEL integration requires manual steps for configuration, making it less user-friendly. 

Since tracing was deemed **low priority** for our users, this area will be explored further on demand.

---

### OpenTelemetry (OTEL)

Dynatrace supports several OTEL ingestion methods. For our architecture, the team selected a **direct OTEL-to-Dynatrace SaaS scheme** ([decision link](link)). Detailed instructions for OTEL tracing setup will be evaluated and provided later.

---

## Work Showcase

### Test Application Deployment

- **GitHub Repository:** [link](link)  
- **Monitoring Dashboards:** Dynatrace, Splunk, Load Balancer (links provided as needed)

### Jira Epics

1. **Epic One:** [link](link)  
2. **Epic Two:** [link](link)  

### Requests Raised

- **Request One:** [link](link)  
- **Request Two:** [link](link)  
- **Request Three:** [link](link)  

---

## Contacts and Collaboration

Communicated with the following people for research and implementation:  

- jeremy.boyer@edwardjones.com – General Dynatrace questions  
- marioantonio.villalobosrodriguez@edwardjones.com – General queries, monitoring setup  
- ponish.jitta@edwardjones.com – Management Zone onboarding  
- saiarthik.sadhu@edwardjones.com – Python runtime monitoring enablement  
- sandhiya.pandisubburaj@edwardjones.com – Test app load balancer setup  
- andrii.khaietskyi@edwardjones.com – CD general questions, test app deployment  
- oleg.beletskyi@edwardjones.com – CD general questions, test app deployment  

---

This document reflects the efforts made to integrate Dynatrace with the python repository template, addressing constraints and providing simplified solutions for logging and metrics collection. Future work on OTEL tracing will depend on user demand.